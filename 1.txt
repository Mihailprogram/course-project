CREATE OR REPLACE FUNCTION sportclub.get_result_coach(coach_id integer)
RETURNS TABLE (
    name character varying,
    last_name character varying,
    age integer,
    name_competition character varying,
    date date,
    rusult integer
)
AS $$
BEGIN
    RETURN QUERY
    SELECT name, last_name, age, name_competition, date, rusult
    FROM sportclub.sport_competition_sportsman AS one
    JOIN sportclub.sport_competition AS two ON one.id_achievments = two.id_achievments
    JOIN sportclub.sportsman AS tr ON one.id_sportsman = tr.id_sportsman
    WHERE one.id_coach = coach_id AND one.rusult IS NOT NULL;
END;
$$ LANGUAGE 'plpgsql';
